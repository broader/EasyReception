import os
import cPickle
import cgi
import urllib
import datetime

from HTMLTags import *
import date_formats
import guess_type

# uncomment next line with the db declaration, like
#import PyDblite
import %(db_engine)s as PyDbLite
db = PyDbLite.Base(REL(%(db_name)s+".pdl"))
db.create(%(db_fields)s,mode="open")

# specify field full names in a dictionary
infos = cPickle.load(open(REL(%(db_name)s+"_infos.dat")))
field_info = infos["fields"]
# mapping between field codes and field names
fnames = dict([(f["code"],f["name"]) for f in field_info])
ftypes = dict([(f["code"],f["type"]) for f in field_info])
# description of form fields
forms = infos["form"]

ext_dbs = {}
for f in field_info:
	if f["type"].startswith("external"):
		ext_db_name = f["type"].split(" ",1)[1]
		ext_dbs[f["code"]] = PyDbLite.Base(REL(ext_db_name+".pdl")).open()
